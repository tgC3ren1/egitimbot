<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bonus Hesaplama â€¢ Pro</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 128 128'><rect width='128' height='128' rx='24' fill='%230b1220'/><text x='50%' y='54%' dominant-baseline='middle' text-anchor='middle' font-size='80' font-family='Arial' fill='%23ff6a3a'>B</text></svg>">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = { theme: { extend: { fontFamily:{ sans:['Inter','ui-sans-serif','system-ui'] }, colors:{ brand1:'#ff6a3a', brand2:'#00e0ff', bg:'#0b1220', card:'#111a30' } } } }
  </script>
  <style>
    :root{ color-scheme: dark; }
    body{ background:
      radial-gradient(1200px 600px at 10% -10%, rgba(255,106,58,.18), transparent 60%),
      radial-gradient(900px 500px at 90% 10%, rgba(0,224,255,.14), transparent 60%),
      linear-gradient(180deg, #0b1220 0%, #0e1628 100%);
      color:#e6edf6;
    }
    .glass{ backdrop-filter: blur(10px); background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.08) }
    .title-grad{ background: linear-gradient(90deg,#fff,#b6f3ff,#7de2ff); -webkit-background-clip:text; background-clip:text; color:transparent }
    .chip{ display:inline-flex; align-items:center; gap:.35rem; padding:.25rem .6rem; border-radius:9999px; font-size:.75rem; background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.1) }
    .inp, .sel{ width:100%; padding:.6rem .8rem; border-radius:.9rem; background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.1); color:#fff; outline:none }
    .inp::placeholder{ color:rgba(255,255,255,.45) }
    .inp:focus,.sel:focus{ box-shadow:0 0 0 2px rgba(0,224,255,.6) inset }
    .btn{ display:inline-flex; align-items:center; justify-content:center; gap:.5rem; padding:.7rem 1.25rem; border-radius:1rem; font-weight:800; background:linear-gradient(90deg,#ff6a3a,#00e0ff); color:#08111f; box-shadow:0 10px 25px rgba(0,224,255,.15); }
    select.sel option, select.sel optgroup{ color:#0b1220; background:#fff; }
  </style>
</head>
<body class="font-sans">
  <!-- HEADER -->
  <header class="max-w-6xl mx-auto px-4 pt-8 pb-4">
    <div class="flex items-center gap-4">
      <div class="h-10 w-10 grid place-items-center rounded-xl bg-white/10 border border-white/10 text-brand2 font-black">B</div>
      <h1 class="text-2xl md:text-3xl font-extrabold title-grad tracking-tight">Bonus Hesaplama</h1>
      <div class="ml-auto hidden md:flex items-center gap-2 text-xs text-white/70">
        <span class="chip">Statik â€¢ GitHub Pages</span>
        <span class="chip">Kurumsal arayÃ¼z</span>
      </div>
    </div>
  </header>

  <!-- CONTROLS -->
  <section class="max-w-6xl mx-auto px-4">
    <div class="glass rounded-2xl p-5">
      <div class="grid md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm mb-1">Bonus</label>
          <select id="bonus" class="sel"></select>
        </div>
        <div>
          <label class="block text-sm mb-1">Alan</label>
          <select id="domain" class="sel">
            <option value="all">TÃ¼mÃ¼ (spor, casino, slot, uÃ§ak)</option>
            <option value="spor">Spor</option>
            <option value="casino">Casino</option>
            <option value="slot">Slot</option>
            <option value="ucak">UÃ§ak / Ã–zel Oyun</option>
          </select>
        </div>
        <div>
          <label class="block text-sm mb-1">YatÄ±rÄ±m</label>
          <input id="deposit" class="inp" placeholder="Ã¶rn. 5000 veya 1.2k" inputmode="decimal">
        </div>
        <div>
          <label class="block text-sm mb-1">YÃ¼zde (opsiyonel)</label>
          <input id="percent" class="inp" placeholder="%25 / 25 / yÃ¼zde 25" inputmode="decimal">
          <p class="text-xs text-white/70 mt-1">Yazmazsan: Ä°lk YatÄ±rÄ±m %100, AyrÄ±calÄ±klÄ± GÃ¼n & Challenge %25, GÃ¼nlÃ¼k Bonus %100.</p>
        </div>
        <div>
          <label class="block text-sm mb-1">KazanÃ§/Bonus TL (opsiyonel)</label>
          <input id="winnings" class="inp" placeholder="Ã¶rn. 1200 (Bonus Buy/Freespin iÃ§in Ã¶nerilir)" inputmode="decimal">
        </div>

        <!-- 3 yatÄ±rÄ±m -->
        <div id="threeBox" class="hidden">
          <label class="block text-sm mb-2">3 YatÄ±rÄ±m (ortalama hediye hesaplanÄ±r)</label>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-2">
            <input id="three1" class="inp" placeholder="1. YatÄ±rÄ±m (Ã¶rn. 1000)" inputmode="decimal">
            <input id="three2" class="inp" placeholder="2. YatÄ±rÄ±m (Ã¶rn. 2000)" inputmode="decimal">
            <input id="three3" class="inp" placeholder="3. YatÄ±rÄ±m (Ã¶rn. 3000)" inputmode="decimal">
          </div>
          <p class="text-xs text-white/70 mt-2">Bu bonus iÃ§in <b>3 yatÄ±rÄ±mÄ±</b> girin; ortalamasÄ± hediye olarak kabul edilir (kampanya tavanlarÄ±na tabidir).</p>
        </div>
      </div>

      <div class="mt-5 flex items-center gap-3">
        <button id="calc" class="btn"><span>Hesapla</span></button>
        <span id="status" class="text-sm text-white/70"></span>
      </div>
    </div>
  </section>

  <!-- RESULTS -->
  <main id="results" class="max-w-6xl mx-auto px-4 py-6 space-y-4"></main>

  <footer class="max-w-6xl mx-auto px-4 pb-10 text-center text-white/50 text-xs">Â© Bonus Hesaplama â€¢ Pro UI â€¢ GitHub Pages uyumlu</footer>

  <script>
  // ======= Dataset (tam) =======
  const PRESETS = [
    { short:'Crypto %40', title:'%40 CRYPTO YatÄ±rÄ±m Bonusu', rules:{ spor:'YatÄ±rÄ±m+Bonus x5 (min 2 maÃ§, her maÃ§ â‰¥1.60)', casino:"YatÄ±rÄ±m+Bonus x10 (Hold'em, Blackjack, Rulet) â€” Baccarat hariÃ§, Rulet max 17 sayÄ±", slot:'YatÄ±rÄ±m+Bonus x10', ucak:'YatÄ±rÄ±m+Bonus x15 (Tombala, Zeplin, Plinko)' }, min_deposit:'100 TL', max_bonus:'100.000 TL', max_withdraw:'YatÄ±rÄ±mÄ±n 20 katÄ±', notes:'KayÄ±p bonusu ile birlikte alÄ±namaz' },
    { short:'Her GÃ¼n Bonus', title:'HAFTANIN HER GÃœNÃœ %100, 2.000 TL', rules:{ spor:'YatÄ±rÄ±m+Bonus x5 (min 2 maÃ§, â‰¥1.60, futbol & basketbol)', casino:"YatÄ±rÄ±m+Bonus x20 (Hold'em, BJ, Rulet 1'e1 hariÃ§; Baccarat yok; Rulet max 17 sayÄ±)", slot:'YatÄ±rÄ±m+Bonus x20', ucak:'â€”' }, min_deposit:'â€”', max_bonus:'2.000 TL', max_withdraw:'Bonus x10, max 20.000 TL', notes:'DiÄŸer kampanyalarla birleÅŸtirilemez' },
    { short:'%25 Limitsiz', title:'%25 LÄ°MÄ°TSÄ°Z YatÄ±rÄ±m Bonusu', rules:{ spor:'YatÄ±rÄ±m+Bonus x3 (min 2 maÃ§, â‰¥1.60)', casino:'YatÄ±rÄ±m+Bonus x5 (oyun ÅŸovlarÄ±, Baccarat vb. hariÃ§)', slot:'YatÄ±rÄ±m+Bonus x5', ucak:'YatÄ±rÄ±m+Bonus x10 (Tombala, Plinko, Spaceman vb.)' }, min_deposit:'50 TL', max_bonus:'Limitsiz', max_withdraw:'â€”', notes:'Rulet max 17 sayÄ±; birÃ§ok oyun hariÃ§' },
    { short:'3+1 YatÄ±rÄ±m', title:'3 YatÄ±rÄ±ma 1 YatÄ±rÄ±m Bizden', rules:{ spor:'Bonus x10 (min 1.55, 2 maÃ§)', casino:'Bonus x20', slot:'Bonus x20', ucak:'Bonus x30' }, min_deposit:'â€”', max_bonus:'2.500 TL', max_withdraw:'Bonus kazancÄ±nÄ±n 7 katÄ±', notes:'Son 3 yatÄ±rÄ±m ortalamasÄ± 4. yatÄ±rÄ±m olarak eklenir' },
    { short:'DoÄŸum GÃ¼nÃ¼', title:'Ã‡evrimsiz 1.000 TL DoÄŸum GÃ¼nÃ¼', rules:{ slot:'Ã‡evrimsiz' }, min_deposit:'â€”', max_bonus:'â€”', max_withdraw:'2.500 TL', notes:'Son 3 ayda â‰¥1.000 TL yatÄ±rÄ±mÄ± olmalÄ±' },
    { short:'HaftalÄ±k KayÄ±p', title:'HaftalÄ±k KayÄ±p Bonusu (%5â€“%10)', rules:{ spor:'Bonus x3 (min 2 maÃ§, â‰¥1.50)', casino:'Bonus x3 (Rulet max 17 sayÄ±, kÄ±rmÄ±zÄ±/siyah/tek-Ã§ift hariÃ§)', slot:'Bonus x3', ucak:'Bonus x5 (Raptor, Spaceman)' }, min_deposit:'Min. kayÄ±p 2.500 TL', max_bonus:'15.000 TL', max_withdraw:'Bonus x10', notes:'Bakiyen 5 TL altÄ± olmalÄ±; Pazartesi talep' },
    { short:'YatÄ±rÄ±m FS', title:'YatÄ±rÄ±ma Ã–zel FreeSpin (50 FS)', rules:{ slot:'Bonus x25 (FS kazancÄ±)', casino:'Bonus x25', ucak:'â€”', spor:'Bonus x7' }, min_deposit:'250 TL', max_bonus:'FS deÄŸeri 4/6/8/10 TL', max_withdraw:'YatÄ±rÄ±m aralÄ±ÄŸÄ±na gÃ¶re 1.000â€“5.000 TL', notes:'Gates of Olympus Super Scatter â€” 50 FS sabit' },
    { short:'%200 Bonus Buy', title:'%200 Bonus Buy â€“ Sweet Bonanza', rules:{ slot:'YatÄ±rÄ±m+Bonus x25 (kazanÃ§ + yatÄ±rÄ±m baz alÄ±nÄ±r)' }, min_deposit:'â€”', max_bonus:'â€”', max_withdraw:'10.000 TL', notes:'Sadece slot, gÃ¼nde 1 kez' },
    { short:'Referral', title:'ArkadaÅŸ Davet Bonusu (Ä°lk %25 â€¢ Ä°kinci %30)', rules:{ spor:'Bonus x3 (min 1.60, 3 maÃ§ kombine)', casino:'Bonus x20', slot:'Bonus x25' }, min_deposit:'Davetlin 2 onaylÄ± yatÄ±rÄ±m (â‰¥100 TL)', max_bonus:'1.000 TL + 1.500 TL', max_withdraw:'Bonus x10', notes:'Linkten kayÄ±t, oyuna baÅŸlamadan baÅŸvuru' },
    { short:'0x %10 Limitsiz', title:'0 Ã‡EVRÄ°M %10 LÄ°MÄ°TSÄ°Z YatÄ±rÄ±m Bonusu', rules:{ spor:'YatÄ±rÄ±m+Bonus x2 (min 2 maÃ§, â‰¥1.50) â€” sanal hariÃ§', casino:'YatÄ±rÄ±m+Bonus x1', slot:'YatÄ±rÄ±m+Bonus x1', ucak:'â€”' }, min_deposit:'50 TL', max_bonus:'Limitsiz', max_withdraw:'â€”', notes:'BirÃ§ok oyun hariÃ§ â€” listesi sayfada' },
    { short:'5X Challenge', title:'DEV ETKÄ°NLÄ°K: Bakiyeni 5X Yap, 10X Ã‡ek', rules:{ slot:'Sadece slot â€” seÃ§eneÄŸe gÃ¶re Ã§ekim: 5k/10k/20k' }, min_deposit:'500 / 1.000 / 2.000 TL seÃ§enek', max_bonus:'â€”', max_withdraw:'5.000 / 10.000 / 20.000 TL', notes:'Payco/Kredi KartÄ± hariÃ§; gÃ¼nde 1 kez' },
    { short:'%200 FS 1000', title:'1.000 TL YatÄ±rÄ±ma %200 Freespin (100 FS)', rules:{ slot:'Bonus x15 (yalnÄ±zca slot)' }, min_deposit:'1.000 TL', max_bonus:'100 FS (20 TL bet)', max_withdraw:'10.000 TL', notes:'Gates of Olympus Super Scatter' },
    { short:'Ä°lk YatÄ±rÄ±m', title:'%200, 30.000 TL Ä°lk YatÄ±rÄ±m (2 kere %100, 15.000 TL)', rules:{ spor:'YatÄ±rÄ±m x1', casino:'Bonus x40', slot:'Bonus x40', ucak:'â€”' }, min_deposit:'100 TL', max_bonus:'15.000 TL (her aÅŸama)', max_withdraw:'50.000 TL', notes:'Baccarat, rulet kÄ±rmÄ±zÄ±/siyah ve tek/Ã§ift sayÄ±lmaz' },
    { short:'AyrÄ±calÄ±klÄ± GÃ¼n', title:"5â€™i 15â€™i 25â€™i AyrÄ±calÄ±klÄ± GÃ¼nler %100 (5.000 TL)", rules:{ spor:'YatÄ±rÄ±m+Bonus x5 (min 1.60, 3 maÃ§)', casino:'YatÄ±rÄ±m+Bonus x20', slot:'YatÄ±rÄ±m+Bonus x25', ucak:'Min 1.45 Ã§arpan' }, min_deposit:'500 TL', max_bonus:'5.000 TL', max_withdraw:'Bonus x10', notes:'SÃ¼re 7 gÃ¼n, diÄŸer promosyonlarla birleÅŸmez' },
    { short:'AnlÄ±k KayÄ±p %30', title:'%30 Otomatik AnlÄ±k KayÄ±p Bonusu', rules:{ slot:'Ã‡evrimsiz', casino:'Ã‡evrimsiz', spor:'Ã‡evrimsiz' }, min_deposit:'KayÄ±p aralÄ±ÄŸÄ±na gÃ¶re', max_bonus:'â€”', max_withdraw:'Discount 20x (500 TL Ã¼zeri)', notes:'Hesap bakiyesi â‰¤5 TL; aktif oyun olmamalÄ±' }
  ];

  // ======= Utils =======
  const TL = n => new Intl.NumberFormat('tr-TR').format(Math.floor(n)) + ' TL';
  const fold = t => (t||'').toString().normalize('NFKD')
    .replace(/[Ã§Ã‡]/g,'c').replace(/[ÄŸÄ]/g,'g').replace(/[Ä±Ä°]/g,'i')
    .replace(/[Ã¶Ã–]/g,'o').replace(/[ÅŸÅ]/g,'s').replace(/[Ã¼Ãœ]/g,'u')
    .toLowerCase();
  function toNumber(str){
    if(!str) return 0;
    let s=String(str).trim().toLowerCase().replace('tl','').replace('â‚º','');
    if(/^\d+(\.\d+)?k$/.test(s)) return parseFloat(s)*1000;
    s=s.replace(/\./g,'').replace(',', '.');
    const m=s.match(/(\d+(?:\.\d+)?)/);
    return m?parseFloat(m[1]):0;
  }
  function parsePercentInput(v){ if(!v) return null; const t=fold(v); const m=t.match(/%?\s*(\d{1,3})/); return m?parseFloat(m[1]):null; }

  // kurallarÄ± metinden basitÃ§e Ã§Ä±karma
  function parseRuleCellText(text){
    const s=(text||'').toString().toLowerCase();
    if(!s) return {basis:'NONE',multiplier:0,raw:text};
    if(s.includes('Ã§evrimsiz')) return {basis:'BONUS',multiplier:0,raw:text};
    let m=s.match(/yat[Ä±i]r[Ä±i]m\+?bonus\s*x\s*(\d+)/);
    if(m) return {basis:'DEPOSIT_PLUS_BONUS',multiplier:+m[1],raw:text};
    if(s.includes('kazanÃ§') && s.includes('yatÄ±rÄ±m') && /x\s*(\d+)/.test(s)){
      const k=s.match(/x\s*(\d+)/);
      return {basis:'DEPOSIT_PLUS_BONUS',multiplier:+(k?k[1]:0),raw:text};
    }
    m=s.match(/bonus\s*x\s*(\d+)/);
    if(m) return {basis:'BONUS',multiplier:+m[1],raw:text};
    m=s.match(/yat[Ä±i]r[Ä±i]m\s*x\s*(\d+)/);
    if(m) return {basis:'DEPOSIT',multiplier:+m[1],raw:text};
    return {basis:'NONE',multiplier:0,raw:text};
  }
  function percentHeuristic(p){
    const n=fold(p.short+' '+p.title);
    if(n.includes('ilk yatirim')) return 100;
    if(n.includes('her gun')) return 100;
    if(n.includes('limitsiz')) return 25;
    if(n.includes('challenge')) return 25;
    return null;
  }
  function parseMaxBonusValue(s){
    if(!s) return null;
    const t=s.trim().toLowerCase();
    if(t.includes('limit yok')||t.includes('limitsiz')||t==='â€”') return null;
    const v=toNumber(t); return v>0?v:null;
  }

  // ======= Hesaplama =======
  function computeWithBonus(preset,domain,deposit,bonusAmount){
    const ruleTxt=(preset.rules||{})[domain]||'';
    const rule=parseRuleCellText(ruleTxt);
    if(rule.basis==='NONE') return {error:`Bu bonus '${domain}' alanÄ±nda geÃ§ersiz.`};

    // bonus tavanÄ±
    let bonusCap = parseMaxBonusValue(preset.max_bonus);
    if(bonusCap!=null && bonusAmount>bonusCap) bonusAmount=bonusCap;

    let base=0, mult=+rule.multiplier||0, required=0;
    if(mult===0){ base=0; required=0; }
    else{
      if(rule.basis==='BONUS') base=bonusAmount;
      else if(rule.basis==='DEPOSIT') base=deposit;
      else base=deposit+bonusAmount;  // YatÄ±rÄ±m+Bonus
      required = base * mult;
    }
    return {domain, deposit:Math.floor(deposit), bonus:Math.floor(bonusAmount), base:Math.floor(base), multiplier:mult, required:Math.floor(required), rule_raw:ruleTxt};
  }
  function computePercent(preset,domain,deposit,percent){
    let bonus=deposit*(percent/100);
    const cap=parseMaxBonusValue(preset.max_bonus);
    if(cap!=null && bonus>cap) bonus=cap;
    return computeWithBonus(preset,domain,deposit,bonus);
  }
  function computeAll(preset,deposit,resolver){
    const out=[];
    for(const dom of ['spor','casino','slot','ucak']){
      const r=(preset.rules||{})[dom];
      if(!r) continue;
      out.push([dom,resolver(dom)]);
    }
    return out;
  }

  // ======= UI =======
  const icon={spor:'âš½',casino:'ğŸ°',slot:'ğŸ§©',ucak:'âœˆï¸'};
  const $bonus=document.getElementById('bonus');
  const $domain=document.getElementById('domain');
  const $deposit=document.getElementById('deposit');
  const $percent=document.getElementById('percent');
  const $winnings=document.getElementById('winnings');
  const $threeBox=document.getElementById('threeBox');
  const $three1=document.getElementById('three1');
  const $three2=document.getElementById('three2');
  const $three3=document.getElementById('three3');
  const $results=document.getElementById('results');
  const $status=document.getElementById('status');

  function fillBonusSelect(){
    $bonus.innerHTML = PRESETS.map((p,i)=>`<option value="${i}">${p.title}</option>`).join('');
    $bonus.dispatchEvent(new Event('change'));
  }
  function isThreeInvestmentPreset(p){
    const s=fold((p.short||'')+' '+(p.title||''));
    return /(3|uc|Ã¼Ã§)\s*yatir(i|Ä±)m/.test(s);
  }
  function isWinningsOnlyPreset(p){
    const s=fold((p.short||'')+' '+(p.title||''));
    return /freespin|free\s*spin|bonus\s*buy/.test(s);
  }

  $bonus.addEventListener('change', e=>{
    const p=PRESETS[+e.target.value];
    const isThree=isThreeInvestmentPreset(p);
    const isWinOnly=isWinningsOnlyPreset(p);

    $threeBox.classList.toggle('hidden', !isThree);
    $deposit.disabled = isThree || isWinOnly;
    $deposit.placeholder = (isThree||isWinOnly) ? 'Bu bonus iÃ§in yatÄ±rÄ±m alanÄ± kullanÄ±lmaz' : 'Ã¶rn. 5000 veya 1.2k';
    $status.textContent = isWinOnly ? "Bu bonus iÃ§in sadece 'KazanÃ§/Bonus TL' girin." : '';

    // DoÄŸum gÃ¼nÃ¼: otomatik 1000 TL
    if(fold(p.short+p.title).includes('dogum') && fold(p.short+p.title).includes('gun')){
      $winnings.value='1000';
    }
  });

  document.getElementById('calc').addEventListener('click', ()=>{
    const preset=PRESETS[+$bonus.value];
    const domain=$domain.value;
    const depInput=toNumber($deposit.value);
    const pctIn=parsePercentInput($percent.value);
    const winIn=toNumber($winnings.value);

    $results.innerHTML=''; $status.textContent='';

    // DoÄŸum GÃ¼nÃ¼ â€” Ã§evrimsiz
    const isBday = fold(preset.short+preset.title).includes('dogum') && fold(preset.short+preset.title).includes('gun');
    if(isBday){
      const gift=1000;
      $results.innerHTML = `
        <div class='glass rounded-2xl p-5'>
          <div class='text-lg font-bold'>ğŸ‰ ${preset.title}</div>
          <div class='mt-2'>ğŸ Hediye: <b>${TL(gift)}</b> â€” âœ… Ã‡evrim yok.</div>
          <div class='mt-2'>ğŸ¯ Slot alanÄ±nda <b>2.500 TL</b> yapÄ±p Ã§ekebilir.</div>
          <div class='text-white/70 text-sm mt-2'>ğŸ“ Son 3 ayda en az <b>1.000 TL</b> yatÄ±rÄ±mÄ± olmasÄ± gereklidir.</div>
        </div>`;
      return;
    }

    const isThree = isThreeInvestmentPreset(preset);
    const isWinOnly = isWinningsOnlyPreset(preset);

    // 3 yatÄ±rÄ±m ortalamasÄ±
    if(isThree){
      const t1=toNumber($three1.value), t2=toNumber($three2.value), t3=toNumber($three3.value);
      if(!(t1>0 && t2>0 && t3>0)){ $status.textContent='3 yatÄ±rÄ±mÄ±n hepsini girin (Ã¶rn. 1000 2000 3000).'; return; }
      const avg = Math.floor((t1+t2+t3)/3);
      const resolver=dom=>computeWithBonus(preset,dom,0,avg);
      const pairs=(domain==='all')?computeAll(preset,avg,resolver):[[domain,resolver(domain)]];
      const title = `${preset.title} â€” Hediye (ortalama): ${TL(avg)}`;
      const subtitle = `1: ${TL(t1)} â€¢ 2: ${TL(t2)} â€¢ 3: ${TL(t3)}  â†’ Ortalama: ${TL(avg)}`;
      renderCards(pairs,{title, subtitle});
      return;
    }

    // Ã–ncelik: KazanÃ§/Bonus girildiyse (Freespin/BonusBuy yatÄ±rÄ±m istemiyor)
    if(winIn>0){
      const dep = isWinOnly ? 0 : depInput;
      const resolver=dom=>computeWithBonus(preset,dom,dep,winIn);
      const pairs=(domain==='all')?computeAll(preset,dep,resolver):[[domain,resolver(domain)]];
      const title = `${preset.title} â€” KazanÃ§/Bonus: ${TL(winIn)}`;
      const subtitle = isWinOnly ? 'YatÄ±rÄ±m gerekmiyor' : `YatÄ±rÄ±m: ${TL(dep)}`;
      renderCards(pairs,{title, subtitle});
      return;
    }

    // Freespin/BonusBuy ise kazanÃ§ zorunlu
    if(isWinOnly){ $status.textContent = "Bu bonus iÃ§in 'KazanÃ§/Bonus TL' girmeniz gerekir."; return; }

    // DiÄŸerlerinde yatÄ±rÄ±m zorunlu
    if(!depInput){ $status.textContent='LÃ¼tfen yatÄ±rÄ±m girin.'; return; }
    const dep = depInput;

    // yÃ¼zde -> hesap
    let pct = pctIn ?? percentHeuristic(preset);
    if(pct==null){ $status.textContent = "YÃ¼zde bulunamadÄ± â€” yÃ¼zde yazÄ±n ya da 'KazanÃ§/Bonus TL' girin."; return; }
    const resolver=dom=>computePercent(preset,dom,dep,pct);
    const pairs=(domain==='all')?computeAll(preset,dep,resolver):[[domain,resolver(domain)]];
    const title = `${preset.title} â€” %${parseInt(pct)}`;
    renderCards(pairs,{title, subtitle:`YatÄ±rÄ±m: ${TL(dep)}`});

    function renderCards(pairs, header, extraNoteHTML=''){
      const chips = (p)=>[
        p.min_deposit?`<span class='chip'>Min: ${p.min_deposit}</span>`:'',
        p.max_bonus?`<span class='chip'>Max bonus: ${p.max_bonus}</span>`:'',
        p.max_withdraw?`<span class='chip'>Max Ã§ekim: ${p.max_withdraw}</span>`:''
      ].filter(Boolean).join(' ');

      const cards = pairs.map(([dom,r])=>{
        if(r.error){
          return `<div class='glass rounded-2xl p-5'>
            <div class='font-semibold'>${icon[dom]} ${dom.toUpperCase()}</div>
            <div class='mt-2 text-rose-300'>${r.error}</div></div>`;
        }
        const raw=r.rule_raw?`<div class='text-xs text-white/60 mt-2'>ğŸ§© ${r.rule_raw}</div>`:'';
        return `<div class='glass rounded-2xl p-5'>
          <div class='font-semibold'>${icon[dom]} ${dom.toUpperCase()}</div>
          <div class='mt-2'>Baz: <b>${TL(r.base)}</b> â€¢ x${r.multiplier||'â€”'} â†’ âœ… <b>${TL(r.required)}</b></div>
          <div class='mt-3 flex flex-wrap gap-2'>${chips(preset)}</div>
          ${raw}
        </div>`;
      }).join('');
      $results.innerHTML = `
        <div class='glass rounded-2xl p-5'>
          <div class='text-lg font-bold'>${header.title}</div>
          <div class='text-white/70 text-sm'>${header.subtitle||''}</div>
          ${extraNoteHTML||''}
        </div>
        <div class='grid grid-cols-1 md:grid-cols-2 gap-4 mt-2'>${cards}</div>`;
    }
  });

  // ---- Basit Smoke testleri ----
  (function selfTest(){
    console.assert(Array.isArray(PRESETS) && PRESETS.length >= 10, 'PRESETS eksik gÃ¶rÃ¼nÃ¼yor.');
    const sel = document.getElementById('bonus');
    console.assert(sel, 'Bonus select bulunamadÄ±.');
  })();

  // Init
  fillBonusSelect();
  </script>
</body>
</html>
